<!DOCTYPE html>
<html>
<head>
  <title>Données Google Sheets</title>
</head>
<body>
  <h1>Tableau depuis Google Sheets</h1>
  <table border="1" id="tableau"></table>

  <script>
    const apiUrl = "https://script.google.com/macros/s/AKfycbwcYYfKG0msA_qLFEgcn-29e3EUH2-bskkcctkWU6ET/devc"; // Remplacez XXX par l'URL fournie

    fetch(apiUrl)
      .then(response => response.json())
      .then(data => {
        const table = document.getElementById("tableau");

        // Création de l'en-tête
        const header = document.createElement("tr");
        Object.keys(data[0]).forEach(key => {
          const th = document.createElement("th");
          th.textContent = key;
          header.appendChild(th);
        });
        table.appendChild(header);

        // Lignes de données
        data.forEach(row => {
          const tr = document.createElement("tr");
          Object.values(row).forEach(cell => {
            const td = document.createElement("td");
            td.textContent = cell;
            tr.appendChild(td);
          });
          table.appendChild(tr);
        });
      });
  </script>
</body>
</html>
